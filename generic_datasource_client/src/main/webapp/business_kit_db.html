<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Matrix Data Source</title>
        <link rel="shortcut icon" href="assets/self-owned/ico/favicon.ico">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/vendor.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/flat-admin.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/theme/blue-sky.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/theme/blue.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/theme/red.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/flat-admin/assets/css/theme/yellow.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/codemirror/codemirror.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/github-markdown-css/github-markdown.css">
        <link rel="stylesheet" type="text/css" href="assets/self-owned/css/matrix_v3.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/bootstrap-fileinput/css/fileinput_ly.css" media="all">
        <link rel="stylesheet" type="text/css" href="assets/reference/fuelux/fuelux.min.css">
        <link rel="stylesheet" type="text/css" href="assets/reference/gridstack/gridstack.css" />
        <link rel="stylesheet" type="text/css" href="assets/reference/gridstack/gridstack-extra.css" />
    </head>

    <body>

        <div class="app app-blue-sky" id="template-matrix-main-div">
            <aside class="app-sidebar" id="sidebar"></aside>
            <div class="app-container" id="main_content_div">
                <nav class="navbar navbar-default navbar-fixed-top" id="navbar"></nav>
                <div class="seperate_div_class" style="margin-top:118px"></div>

                <!--LOADER DIV BEGIN-->
                <div class="loader-container text-center">
                    <div class="icon">
                        <div class="sk-wave">
                            <div class="sk-rect sk-rect1"></div>
                            <div class="sk-rect sk-rect2"></div>
                            <div class="sk-rect sk-rect3"></div>
                            <div class="sk-rect sk-rect4"></div>
                            <div class="sk-rect sk-rect5"></div>
                        </div>
                    </div>
                    <div class="title">Loading</div>
                </div>
                <!--LOADER DIV FINISHED-->

                <!--RESPONSE DIV BEGIN-->
                <div class="row" data-bind="with:response_vm">
                    <div class="col-sm-12" style="margin-bottom:12px;display:none" data-bind="visible: resultVisible">
                        <div class="flat-matrix">
                            <div class="alert fresh-color " data-bind="css:styleClass,visible: resultVisible" style="display:none">
                                <button type="button" class="close" data-bind="click:function(){resultVisible(false)}" aria-label="Close"><i class="fa fa-close"></i></button>
                                <strong>
                                    <span data-bind="text:resultTitle"></span>
                                </strong>
                                <span data-bind="text:resultSubTitle"></span>
                                <div data-bind="text:resultContent"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--RESPONSE DIV FINISHED-->

                <!--VALIDATION DIV BEGIN-->
                <div class="row">
                    <div class="col-sm-12" style="margin-bottom:12px;display:none" data-bind="visible: hasError">
                        <div id="validation_div">
                            <div class="flat-matrix">
                                <div class="alert alert-warning alert-dismissible fresh-color" role="alert" style="display:none" data-bind="visible: hasError">
                                    <button type="button" data-bind="click:function(){hasError(!hasError)}" class="close" aria-label="Close">
                                        <i class="fa fa-close"></i>
                                    </button>
                                    <strong>Warning:</strong>
                                    <div id="errorMessagesDIV" data-bind="foreach:errorMessage">
                                        <div data-bind="text:$data"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--VALIDATION DIV FINISHED-->


                <!--Business Begin-->
                <div class="row" id="database-connection" data-bind="with:businessPOJO">
                    <div class="col-sm-12" data-bind="visible:connectionVisible">
                        <div class="card card-mini" >
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fa fa-diamond">&nbsp;Database Connection  &nbsp;&nbsp;&nbsp;</i>                    
                                </div>
                                <button type="button" class="btn btn-xs btn-default" title="新增"  onclick="addConnection()">
                                    <i class="fa fa-plus fa-1x"></i>
                                </button>      
                            </div>
                            <div class="card-body" >
                                <div id="connection_div" style="width: 100%;height:100%;">
                                    <div class="table_div_class">
                                        <div class="row" data-bind="with:databaseConnections">
                                            <div class="col-xs-12" style="overflow: auto">
                                                <table class="table table-striped table-hover" cellspacing="0">
                                                    <thead>
                                                        <tr>
                                                            <!-- ko foreach: columnNames -->
                                                            <th>
                                                                <span data-bind="text: $data"></span>
                                                            </th>
                                                            <!-- /ko -->

                                                        </tr>

                                                    </thead>
                                                    <tbody data-bind="foreach:thinViewData">
                                                        <tr data-bind="visible:isDisplay">
                                                            <td data-bind="text: data[0]"></td> 
                                                            <td data-bind="text: data[1]"></td> 
                                                            <td data-bind="text: data[2]"></td> 
                                                            <!--                                                            <td data-bind=""> 
                                                                                                                            <span class="label label-success" style="margin-left: -200px;">Success</span>
                                                                                                                            <span class="label label-danger" style="margin-left: -200px;"> &nbsp;Wrong &nbsp;</span>
                                                                                                                        </td>-->
                                                            <td>
                                                                <button type="button" class="btn btn-xs btn-default" title=" 新增數據源"  data-bind="click:(function(){chooseDataBase($data.data);})">
                                                                    <i class="fa fa-check fa-1x"></i>
                                                                </button>                                                   

                                                                <button type="button" class="btn btn-xs btn-default" title="编辑" data-bind="click:(function(){detailConnection($data.data);})">
                                                                    <i class="fa fa-wrench fa-1x"></i>
                                                                </button>
                                                                <button title="Remove" data-bind="click:function(){ModalUtil.popup_modal_with_businessPOJO('DELETE CONNECTION', '/modal_connection_remove.html', $data.data, null,null);}" type="button" class="btn btn-xs btn-default" >
                                                                    <i class="fa fa-trash-o"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="matrix-pager-v3" data-bind="visible:isDisplayPager">
                                                <div class="form-inline">
                                                    <nav>
                                                        <form>
                                                            <span class="pull-left">
                                                                <label class="control-label" style="margin-bottom: 12px;">Total Counts:<span data-bind="text:totalCounts()?totalCounts():0"></span></label>
                                                            </span>
                                                        </form>
                                                        <span class="pull-right">
                                                            <button data-bind="click:function(){toPage(1);}" type="button" class="btn btn-default " style="padding: 10px 12px;"><i class="fa fa-angle-double-left"></i> &nbsp;First</button>
                                                            <button data-bind="click:function(){toPage(currentPageNumber()-1);}" type="button" class="btn btn-default " style="padding: 10px 12px;"><i class="fa fa-angle-left"></i> &nbsp;Previous</button>
                                                            <input data-bind="value:currentPageNumber" type="text" class="form-control" placeholder="Page" style="width:60px;margin-bottom:5px;padding:10px;text-align: center;">
                                                            <button data-bind="visible:false,click:function(){}" type="submit" class="btn"><span class="fui-search"></span></button>
                                                            <button data-bind="click:function(){toPage(currentPageNumber()+1);}" type="button" class="btn btn-default " style="padding: 10px 12px;">Next &nbsp;<i class="fa fa-angle-right"></i></button>
                                                            <button data-bind="click:function(){toPage(totalPage());}" type="button" class="btn btn-default " style="padding: 10px 12px;">Last &nbsp;<i class="fa fa-angle-double-right"></i></button>
                                                            <div class="btn-group">
                                                                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><span data-bind="text:pageMaxSize()"></span> <span class="caret"></span></button>
                                                                <ul class="dropdown-menu" role="menu" data-bind="foreach: pagingSizeArray">
                                                                    <li><a data-bind="click:function(){$parent.pageMaxSize($data)}" href="#"><span data-bind="text:$data"></span></a></li>
                                                                </ul>
                                                            </div>
                                                        </span>
                                                    </nav>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" id="datasource-detail" data-bind="with:businessPOJO">
                    <div class="col-sm-12" data-bind="visible:detailVisible">
                        <div class="card card-mini">
                            <div class="card-header">
                                <div class="card-title" >
                                    <i class="fa fa-diamond">&nbsp;Data Source Detail  &nbsp;&nbsp;&nbsp;</i>                    
                                    <button title="Remove" data-toggle="modal" data-target="#myModal" type="button" class="btn btn-default pull-right" style="padding: 6px 8px;margin-bottom: 0px;margin-right:8px;"><i class="fa fa-trash-o"></i>&nbsp;</button>&nbsp;
                                    <button title="Update" onclick="Update()" type="button" class="btn btn-default pull-right" style="padding: 6px 8px;margin-bottom: 0px;margin-right:8px;"><i class="fa fa-cogs"></i>&nbsp;</button>
                                </div>  
                                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                                <h4 class="modal-title">DELETE</h4>
                                            </div>
                                            <div class="modal-body">
                                                <p>Delete current data source?</p>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-sm btn-default" data-dismiss="modal">Close</button>
                                                <button type="button" class="btn btn-sm btn-success" onclick="Remove()">Yes</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body" style="padding: 20px 30px 20px 30px;">
                                <div >
                                    <div class="row">
                                        <div class="col-xs-2 text-right">
                                            <label style="margin-top:8px;">Creator:
                                            </label>
                                        </div>
                                        <div class="col-xs-4" style="margin-top: 2px;">
                                            <p class="form-control-static" data-bind="text:creator"></p>
                                        </div>
                                        <div class="col-xs-2 text-right">
                                            <label style="margin-top:8px;">Date:
                                            </label>
                                        </div>
                                        <div class="col-xs-4" style="margin-top: 2px;">
                                            <p class="form-control-static" data-bind="text:formatTime"></p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-2 text-right">
                                            <label style="margin-top:8px;">Data Source Name:
                                            </label>
                                        </div>
                                        <div class="col-xs-10" style="margin-top: 2px;">
                                            <p class="form-control-static" data-bind="text:name()?name():''"></p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-2 text-right">
                                            <label style="margin-top:8px;">Data Source Description:
                                            </label>
                                        </div>
                                        <div class="col-xs-10" style="margin-top: 2px;">
                                            <p class="form-control-static" data-bind="text:description()?description():''"></p>
                                        </div>
                                    </div>
                                    <hr style="border-top: 2px solid #39c3da;"><span class="label label-info">Data Source Table</span>
                                    <div data-bind="visible:!(data_source_table_display())">
                                        <div class="flat-matrix">
                                            <div class="alert alert-info alert-dismissible fresh-color" role="alert" style="margin-top: 16px;">
                                                <strong><i class="fa fa-warning"></i>&nbsp;Tips:</strong> &nbsp;Table Not Initialized.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div id="copy_table_parent_div"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" id="database-setting" data-bind="with:businessPOJO">
                    <div class="col-md-12" data-bind="visible: databasesetVisible">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fa fa-diamond">&nbsp;Data Source Configuration&nbsp;&nbsp;&nbsp;</i>
                                </div>
                            </div>
                            <div class="card-body flat-matrix" >
                                <div class="step-v2-success">
                                    <ul class="nav nav-tabs nav-justified" role="tablist">
                                        <li id="startstep" role="step" class="active">
                                            <a href="#step1-v3-horizantal" id="step1-tab-v3-horizantal" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">
                                                <div class="icon fa fa-key"></div>
                                                <div class="heading">
                                                    <div class="title">Setting From Database</div>
                                                    <div class="description">Choose database type</div>
                                                </div>
                                            </a>
                                        </li>
                                        <li role="step" class="">
                                            <a href="#step2-v3-horizantal" role="tab" id="step2-tab-v3-horizantal" data-toggle="tab" aria-controls="profile" aria-expanded="false">
                                                <div class="icon fa fa-filter"></div>
                                                <div class="heading">
                                                    <div class="title">Detail Setting</div>
                                                    <div class="description">Configuration</div>
                                                </div>
                                            </a>
                                        </li>                        
                                        <li role="step" class="">
                                            <a href="#step3-v3-horizantal" role="tab" id="step3-tab-v3-horizantal" data-toggle="tab" aria-controls="profile" aria-expanded="false">
                                                <div class="icon fa fa-flag-checkered "></div>
                                                <div class="heading">
                                                    <div class="title">Persist</div>
                                                    <div class="description">Persist this for re-use purpose</div>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                    <!-- Tab panes -->
                                    <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="step1-v3-horizantal">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 选择外接数据库类型及驱动名称 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Database Type:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;">
                                                    <div>
                                                        <div class="radio radio-inline" >
                                                            <input type="radio" name="dirverchoose" data-bind="checked:databaseType" id="Postgresql" value="Postgresql" checked>
                                                            <label for="Postgresql">
                                                                Postgresql
                                                            </label>
                                                        </div>
                                                        <div class="radio radio-inline">
                                                            <input type="radio" data-bind="checked:databaseType" name="dirverchoose" id="MySql" value="MySql" >
                                                            <label for="MySql">
                                                                MySql
                                                            </label>
                                                        </div>
                                                        <div class="radio radio-inline">
                                                            <input type="radio" data-bind="checked:databaseType" name="dirverchoose" id="Oracle" value="Oracle">
                                                            <label for="Oracle">
                                                                Oracle
                                                            </label>
                                                        </div>
                                                        <div class="radio radio-inline">
                                                            <input type="radio" data-bind="checked:databaseType" name="dirverchoose" id="GreenPlum" value="GreenPlum">
                                                            <label for="GreenPlum">
                                                                GreenPlum
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Database Driver:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;margin-top: 8px;margin-left: 14px;">
                                                    <span data-bind="text:databaseDriver" ></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:15px;">Database URL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;margin-top: 8px;">
                                                    <input id="databaseUrl" data-bind="value:databaseUrl" type="text" class="form-control" placeholder="">
                                                </div>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="step2-v3-horizantal">
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Connection Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;">
                                                    <input data-bind="value:connectionName" type="text" class="form-control" placeholder="">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">User Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;">
                                                    <input data-bind="value:username" type="text" class="form-control" placeholder="">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Password:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="padding-left: 0px;padding-right: 0px;">
                                                    <input id="DBpassword" data-bind="value:passwd" type="password" class="form-control" placeholder="">
                                                </div>
                                                <div class="col-xs-2">
                                                    <button class="btn btn-primary btn-sm" type="button" onclick="showPasswd()"> 
                                                        <span class="fa fa-eye" aria-hidden="true" title="chart">&nbsp;查看</span>
                                                        <iframe id="tmp_downloadhelper_iframe" style="display: none;"></iframe>
                                                    </button>
                                                </div>  
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="step3-v3-horizantal">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 验证信息 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database Type:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseType"></span>
                                                </div>
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database Driver:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseDriver"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database User:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:username"></span>
                                                </div>
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Connection Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:connectionName"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database URL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseUrl"></span>
                                                </div>                                                 
                                            </div>

                                            <hr>
                                            <div class="row">
                                                <div class="pull-right">
                                                    <button id="testUpdate" type="button" class="btn btn-sm btn-info" style="display:none" onclick="runTest()">Check</button>
                                                    <button id="excuteUpdate" type="button" class="btn btn-sm btn-success" style="display:none" onclick="excuteUpdateConnection()">Update</button>
                                                    <button id="testConnection" type="button" class="btn btn-sm btn-info" onclick="testConnection()">Check</button>
                                                    <button id="excuteNew" type="button" class="btn btn-sm btn-success"  onclick="excuteAddConnection()">Execute</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row" id="datasource-setting" data-bind="with:businessPOJO">
                    <div class="col-md-12" data-bind="visible: datasourcesetVisible">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">
                                    <i class="fa fa-diamond">&nbsp;Data Source &nbsp;&nbsp;&nbsp;</i>
                                </div>
                            </div>
                            <div class="card-body flat-matrix" >
                                <div class="step-v2-success">
                                    <ul class="nav nav-tabs nav-justified" role="tablist">
                                        <li role="step" class="active">
                                            <a href="#step1-v3-horizantal-table" id="step1-data-v3-horizantal" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">
                                                <div class="icon fa fa-key"></div>
                                                <div class="heading">
                                                    <div class="title">Table Name</div>
                                                    <div class="description">Write a name</div>
                                                </div>
                                            </a>
                                        </li>
                                        <li role="step" class="" >
                                            <a href="#step2-v3-horizantal-table" role="tab" id="step2-data-v3-horizantal" data-toggle="tab" aria-controls="profile" aria-expanded="false" data-bind="click:function(){applyCodeMirror()}">
                                                <div class="icon fa fa-filter"></div>
                                                <div class="heading">
                                                    <div class="title">Write SQL</div>
                                                    <div class="description">Write sql</div>
                                                </div>
                                            </a>
                                        </li>    
                                        <li role="step" class="">
                                            <a href="#step3-v3-horizantal-table" role="tab" id="step4-data-v3-horizantal" data-toggle="tab" aria-controls="profile" aria-expanded="false">
                                                <div class="icon fa fa-flag-checkered "></div>
                                                <div class="heading">
                                                    <div class="title">Fresh Time</div>
                                                    <div class="description">Choose fresh time</div>
                                                </div>
                                            </a>
                                        </li>
                                        <li role="step" class="">
                                            <a href="#step4-v3-horizantal-table" role="tab" id="step4-data-v3-horizantal" data-toggle="tab" aria-controls="profile" aria-expanded="false">
                                                <div class="icon fa fa-flag-checkered "></div>
                                                <div class="heading">
                                                    <div class="title">Persist</div>
                                                    <div class="description">Persist into Database</div>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                    <!-- Tab panes -->
                                    <div class="tab-content">
                                        <div role="tabpanel" class="tab-pane active" id="step1-v3-horizantal-table">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 数据表命名 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row ">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Data Source Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="padding-left: 10px;padding-right: 15px;">
                                                    <input type="text" data-bind="value: name" class="form-control" placeholder="Data Source Name">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Database Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-8" style="margin-top: 10px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[0]"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Database URL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 10px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[2]"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="step2-v3-horizantal-table" >
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 数据库相关信息 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12" style='margin-bottom:10px'>
                                                    <div class="card card-tab card-mini">  
                                                        <p class="text-center" id="show_scalable_region_div">
                                                            <button type="button" onclick="show_configuration_panel('assist_div', 'show_scalable_region_div', 'hide_scalable_region_div')" class="btn btn-default" style="border: 0px solid;box-shadow: none;margin-top: 5px;"><i class="fa fa-angle-double-down"></i></button>
                                                        </p>
                                                        <div class="card-body tab-content no-padding flat-matrix" id="assist_div" style="display:none">
                                                            <div  role="tabpanel" class="tab-pane active" id="tab1" style="padding: 20px 30px 0px 30px">
                                                                <div class="row">
                                                                    <div class="col-md-4" id="rdms_database_view">
                                                                        <div data-bind="visible:!databaseSelected.schemaHasResult()" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 请等待加载数据库
                                                                        </div>
                                                                        <div style="display:none" data-bind="visible:databaseSelected.schemaHasResult() && databaseSelected.availableSchema().length === 0" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 您还没有创建数据库
                                                                        </div>
                                                                        <div class="fuelux" style="color:#666;display:none" data-bind="visible:databaseSelected.schemaHasResult() && databaseSelected.availableSchema().length !== 0">
                                                                            <ul class="tree tree-folder-select" role="tree" id="matrix_tree" style="border:0px solid #666;min-width: 250px;min-height: 250px;max-width: 100%;max-height: 250px;overflow: auto;" data-bind="foreach:databaseSelected.availableSchema">
                                                                                <li class="tree-branch" data-template="treebranch" role="treeitem" aria-expanded="false" data-bind="css: {'tree-selected' :$parent.selectedSchema === $data}">
                                                                                    <div class="tree-branch-header">
                                                                                        <button type="button" class="fa fa-database icon-caret">
                                                                                            <span class="sr-only">Open</span>
                                                                                        </button>
                                                                                        <button type="button" class="tree-branch-name" data-bind="click:function() {getTableInDatabase($data);}">
                                                                                            <span class="tree-label"><!--ko text: ' ' + $data.name--><!--/ko--></span>
                                                                                        </button>
                                                                                    </div>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4" id="rdms_table_view">
                                                                        <div data-bind="visible:!databaseSelected.tableHasResult()" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 请在左侧选中要查看的目录
                                                                        </div>
                                                                        <div style="display:none" data-bind="visible:databaseSelected.tableHasResult() && databaseSelected.availableTable().length === 0" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 您还没有创建表
                                                                        </div>
                                                                        <div class="fuelux" style="color:#666;display:none" data-bind="visible:databaseSelected.tableHasResult() && databaseSelected.availableTable().length !== 0">
                                                                            <ul class="tree tree-folder-select" role="tree" id="matrix_tree" style="border:0px solid #666;min-width: 250px;min-height: 250px;max-width: 100%;max-height: 250px;overflow: auto;" data-bind="foreach:databaseSelected.availableTable">
                                                                                <li class="tree-branch" data-template="treebranch" role="treeitem" aria-expanded="false" data-bind="css: {'tree-selected' :$parent.selectedTable === $data}">
                                                                                    <div class="tree-branch-header">
                                                                                        <button type="button" class="glyphicon icon-caret glyphicon-th-list">
                                                                                            <span class="sr-only">Open</span>
                                                                                        </button>
                                                                                        <button type="button" class="tree-branch-name" data-bind="click:function() {getColumnInTable($data);}">
                                                                                            <span class="tree-label"><!--ko text: ' ' + $data.name--><!--/ko--></span>
                                                                                        </button>
                                                                                    </div>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4" id="rdms_column_view">
                                                                        <div data-bind="visible:!databaseSelected.columnHasResult()" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 请在左侧选中要查看的表
                                                                        </div>
                                                                        <div style="display:none" data-bind="visible:databaseSelected.columnHasResult() && databaseSelected.column().length === 0" class="info-text">
                                                                            <i class="fa fa-info-circle"></i> 您还没有创建列
                                                                        </div>
                                                                        <div class="fuelux" style="color:#666;display:none" data-bind="visible:databaseSelected.columnHasResult() && databaseSelected.column().length !== 0">
                                                                            <ul class="tree tree-folder-select" role="tree" id="matrix_tree" style="border:0px solid #666;min-width: 250px;min-height: 250px;max-width: 100%;max-height: 250px;overflow: auto;" data-bind="foreach:databaseSelected.column">
                                                                                <li class="tree-branch" data-template="treebranch" role="treeitem" aria-expanded="false" data-bind="css: {'tree-selected' :$parent.selectedColumn === $data}">
                                                                                    <div class="tree-branch-header">
                                                                                        <button type="button" class="fa fa-ellipsis-v icon-caret">
                                                                                            <span class="sr-only">Open</span>
                                                                                        </button>
                                                                                        <button type="button" class="tree-branch-name">
                                                                                            <span class="tree-label"><!--ko text: ' ' + $data.name--><!--/ko--> </span>
                                                                                        </button>
                                                                                    </div>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                            <div class="row" style="padding: 0px">
                                                                <div class="col-md-12">
                                                                    <div class="alert alert-danger alert-dismissible fresh-color" role="alert" style="margin: 0px;display: none" id="assist-alert">
                                                                        <button type="button" class="close" onclick="hide_div('assist-alert')"><i class="fa fa-close"></i></button>
                                                                        <strong><i class="fa fa-warning fa-6x"></i>&nbsp;错误！</strong><span id="assist-alert-text">工作台返回的错误级别信息，详细描述及错误代码。</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <p class="text-center" id="hide_scalable_region_div" style='margin-bottom: 0px; display:none'>
                                                            <button type="button" onclick="hide_configuration_panel('assist_div', 'show_scalable_region_div', 'hide_scalable_region_div')" class="btn btn-default" style="border: 0px solid;box-shadow: none;"><i class="fa fa-angle-double-up"></i></button>
                                                        </p>

                                                    </div>
                                                </div>                                                
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> SQL语句 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row" >
                                                <div class="col-xs-12">
                                                    <textarea  class="animated" id="sql_div" data-bind="value:sql"  rows="10" placeholder="请在这里键入sql" spellcheck="false" style="font-family: monospace; width: 100%; border: 1px solid #eee; height: 28px"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="step3-v3-horizantal-table">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 选择刷新时间 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[0]"></span>
                                                </div>
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database URL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-4" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[2],attr: {title:databaseSelected.selectedDatabase()[2]}"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">SQL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:sql"></span>
                                                </div>                                                 
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:10px;">Refresh Interval:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 0px;">
                                                    <div class="radio radio-inline">
                                                        <input type="radio" data-bind="checked:stringzeta_refresh_interval" name="radio_stringzeta_refresh_interval" id="radio1" value="10" checked>
                                                        <label for="radio1">
                                                            10 Seconds
                                                        </label>
                                                    </div>
                                                    <div class="radio radio-inline">
                                                        <input type="radio" data-bind="checked:stringzeta_refresh_interval" name="radio_stringzeta_refresh_interval" id="radio2" value="30">
                                                        <label for="radio2">
                                                            30 Seconds
                                                        </label>
                                                    </div>
                                                    <div class="radio radio-inline">
                                                        <input type="radio" data-bind="checked:stringzeta_refresh_interval" name="radio_stringzeta_refresh_interval" id="radio3" value="60">
                                                        <label for="radio3">
                                                            1 Minutes
                                                        </label>
                                                    </div>
                                                    <div class="radio radio-inline">
                                                        <input type="radio" data-bind="checked:stringzeta_refresh_interval" name="radio_stringzeta_refresh_interval" id="radio4" value="300">
                                                        <label for="radio4">
                                                            5 Minutes
                                                        </label>
                                                    </div>
                                                    <div class="radio radio-inline">
                                                        <input type="radio" data-bind="checked:stringzeta_refresh_interval" name="radio_stringzeta_refresh_interval" id="radio5" value="3000000">
                                                        <label for="radio5">
                                                            Never
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr>
                                        </div>
                                        <div role="tabpanel" class="tab-pane" id="step4-v3-horizantal-table">
                                            <div class="row">
                                                <div class="col-xs-12">
                                                    <div class="flat-matrix">
                                                        <div class="alert alert-info fresh-color">
                                                            <div class="title"><i class="fa fa-cogs"></i> 验证信息 :</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Data Source Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:name"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database Name:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[0]"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Database URL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:databaseSelected.selectedDatabase()[2],attr: {title:databaseSelected.selectedDatabase()[2]}"></span>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">SQL:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:sql"></span>
                                                </div>                                                 
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:8px;">Refresh Interval:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 8px;">
                                                    <span data-bind="text:stringzeta_refresh_interval"></span>
                                                </div>                                                 
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-2 text-right">
                                                    <label style="margin-top:0px;">Data Source JSON:
                                                    </label>
                                                    <i class="fa fa-asterisk" style="color: #E74C3C;"></i>
                                                </div>
                                                <div class="col-xs-10" style="margin-top: 0px;">
                                                    <div class="compile_mode_focus_in" tabindex="100">
                                                        <span class="cell_div_view markdown-body" data-bind="html:ds"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row">
                                                <div class="pull-right">
                                                    <button id="excuteNew" type="button" class="btn btn-sm btn-success" onclick="tableset_execute()">Execute</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--BUSINESS DIV FINISHED-->


                <!--TEMPLATE DIV BEGIN-->
                <div id="template-matrix-dynamic-table-div"></div>
                <div id="template-matrix-modal-div"></div>
                <!--TEMPLATE DIV BEGIN-->
                <div id="template-matrix-footer-div"></div>
            </div>
        </div>






        <!-- Javascript for Matrix Referenced -->
        <script src="assets/reference/flat-admin/assets/js/vendor_min.js"></script>
        <script src="assets/reference/flat-admin/assets/js/app.js"></script>
        <script src="assets/reference/codemirror/codemirror.js"></script>
        <script src="assets/reference/codemirror/mode/javascript/javascript.js"></script>
        <script src="assets/reference/codemirror/mode/markdown/markdown.js"></script>
        <script src="assets/reference/jquery/jquery.json.js"></script>
        <script src="assets/reference/jquery/jquery.blockUI.js"></script>
        <script src="assets/reference/knockout.js/knockout-3.3.0.js"></script>
        <script src="assets/reference/jquery-tiny-pubsub/tiny-pubsub.js"></script>
        <script src="assets/reference/markdown/markdown.min.js"></script>
        <script src="assets/reference/jquery-ui/jquery-ui.js"></script>
        <script src="assets/reference/lodash/lodash-4.15.0.js"></script>
        <script src="assets/reference/gridstack/gridstack.all.js"></script>
        <script src="assets/reference/echarts/echarts-min.js"></script>
        <script src="assets/reference/echarts/dataTools.js"></script>
        <script src="assets/reference/codemirror/codemirror.js"></script>
        <script src="assets/reference/codemirror/mode/sql/sql.js"></script>
        <script src="assets/reference/jquery/jquery.autosize.js"></script>

        <!-- Javascript for Matrix Self Owned -->
        <script src="assets/self-owned/js/generic/generic_algorithm.js"></script>
        <script src="assets/self-owned/js/generic/generic_cache.js"></script>
        <script src="assets/self-owned/js/generic/generic_charting_v4.js"></script>
        <script src="assets/self-owned/js/generic/generic_csv.js"></script>
        <script src="assets/self-owned/js/generic/generic_cud.js"></script>
        <script src="assets/self-owned/js/generic/generic_modal.js"></script>
        <script src="assets/self-owned/js/generic/generic_query.js"></script>
        <script src="assets/self-owned/js/generic/generic_table.js"></script>
        <script src="assets/self-owned/js/generic/generic_util.js"></script>
        <script src="assets/self-owned/js/generic/generic_validation.js"></script>
        <script src="assets/self-owned/js/generic/generic_workbench.js"></script>
        <script src="assets/self-owned/js/generic/generic_dynamic.js"></script>
        <script src="assets/self-owned/js/generic/generic_vm.js"></script>
        <script src="assets/self-owned/js/ds/token.js" ></script>
        <script src="assets/self-owned/js/ds/kit_db_business.js"></script>
        <!-- tree 组件专用[BEGIN]-->
        <script src="assets/reference/fuelux/tree.js"></script>
        <!-- tree 组件专用[END]-->



        <script>
                                                    $(document).ready(function () {
                                                        $('#sidebar').load($.getRootPath() + '/components/left_side.html');
                                                        $('#navbar').load($.getRootPath() + '/components/header.html');
                                                        $('#template-matrix-dynamic-table-div').load($.getRootPath() + '/components/template-matrix-dynamic-table.html');
                                                        $('#template-matrix-modal-div').load($.getRootPath() + '/components/template-matrix-modal.html');
                                                        $('#template-matrix-footer-div').load($.getRootPath() + '/components/footer.html');
                                                        

                                                        setTimeout(function () {
                                                            // resetCssClass('li_kits', 'active');
                                                            $('#navbar_title_li').text('Data Source Kit (Database)');
                                                            // $('#navbar_search_li').css('display', '');

                                                            // env_setup();
                                                        }, 200)
                                                    });
                                                    
        </script>

        <script>
            var firstTimeToStep2= true;
         function applyCodeMirror(){
             setTimeout(function () {
             if (firstTimeToStep2) {
                   var myCode = CodeMirror.fromTextArea(document.getElementById('sql_div'),{
                lineNumbers:false,
                mode:"text/x-sql",
                lineWrapping:true
            });
            vm.businessPOJO().codeMirror = myCode;
             firstTimeToStep2 = false;
            autosize($('.CodeMirror'));
             }
          }, 200);
        }
            $.subscribe("get_user_detail_chain_finished", env_setup);
        </script>
        <script>
            
        </script>




    </body>

</html>
